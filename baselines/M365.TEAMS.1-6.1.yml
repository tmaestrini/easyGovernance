Topic: MS Teams
Type: Baseline
Id: M365.1-6.1
Version: 1.0

References:
  - https://www.cisa.gov/sites/default/files/2023-12/Teams%20SCB_12.20.2023.pdf
  - https://web.archive.org/web/20250311072210/https://blueprint.oobe.com.au/as-built-as-configured/office-365/#microsoft-teams

Configuration:
  - enforces: Teams settings
    with:
      FeedSuggestionsInUsersActivityFeed: Allow
      WhoCanManageTags: TeamOwners
      LetTeamOwnersChangeWhoCanManageTags: Allow
      CustomTags: Allow
      ShiftsAppCanApplyTags: Allow
      AllowUsersCanSendEmailsToAChannel: Allow
      AllowCitrix: Block
      AllowDropBox: Block
      AllowBox: Block
      AllowGoogleDrive: Block
      AllowEgnyte: Block
      AllowOrganizationTabForUsers: Allow
      Require2ndAuthforMeeting: NoAccess
      SetContentPin: RequiredOutsideScheduleMeeting
      SurfaceHubCanSendMails: Allow
      ScopeDirectorySearch: Allow
      ExtendedWorkInfoInPeopleSearch: Block
      RoleBasedChatPermissions: Block
      # ProvideLinkToSupportRequestPage: false # TODO: ⭐️ discuss API call (do you know how to get it?)

  - enforces: Org-wide default Teams policy
    with:
      # Name: "Global" # not settable anymore (default policy in admin center)
      CreatePrivateChannels: Allow

  - enforces: Org-wide default Teams App policy
    with:
      Name: "Global"
      # MicrosoftApps: Allow # TODO: ⭐️ discuss API call (do you know how to get it?)
      # ThirdPartyApps: Block # TODO: ⭐️ discuss API call (do you know how to get it?)
      UploadCustomApps: Block
      UserPinning: Allow

  - enforces: Org-wide default Teams Calling policy
    with:
      Name: "Global"
      MakePrivateCalls: Allow
      CloudRecordingForCalling: Block
      # InternalCallForwardingAndRinging: Allow # TODO: ⭐️ discuss API call (do you know how to get it?)
      # ExternalCallForwardingAndRinging: Block # TODO: ⭐️ discuss API call (do you know how to get it?)
      VoicemailEnabledForRoutingInboundCalls: AlwaysEnabled || UserOverride
      # DelegationInboundOutbound: Allow # TODO: ⭐️ discuss API call (do you know how to get it?)
      PreventTollBypass: Block
      MusicOnHoldPSTN: Enabled
      BusyOnBusy: Allow
      WebPSTNCalling: Block
      RealTimeCaptions: Allow
      AutoAnswerMeetingInvites: Block
      SIPDevicesPerformCalling: Block
      CopilotEnabled: Block # TODO: ⭐️ discuss API call (what value are we going to recommend?)

  - enforces: Global Teams meeting policy
    with:
      Name: "Global"
      MeetNowInChannels: Allow
      OutlookAddIn: Allow
      ChannelMeetingScheduling: Allow
      PrivateMeetingScheduling: Allow
      EngagementReport: Allow
      MeetingRegistration: Allow
      WhoCanRegister: Everyone
      Audio: Allow
      ModeForIPAudio: EnabledOutgoingIncoming
      ModeforIPVideo: EnabledOutgoingIncoming
      IPVideo: Allow
      LocalBroadcasting: Block
      MediaBitRateKb: 50000
      NetworkConfigurationLookup: Block
      Transcription: Block
      CloudRecording: Allow
      MeetingsAutomaticallyExpire: Allow
      DefaultExpirationTimeDays: 60
      StoreRecordingsOutsideofYourCountry: Block
      ScreenSharingMode: EntireScreen
      AllowInternalParticipantGiveRequestControl: Allow
      AllowExternalParticipantGiveRequestControl: Block
      PowerPointSharing: Allow
      Whiteboard: Allow
      SharedNotes: Allow
      SelectVideoFilters: AllFilters
      AnonymousJoinMeeting: Block
      AnonymousStartMeeting: Block
      RolesWithPresenterRights: EveryoneUserOverride # Everyone, but user can override
      AutoAdmitPeople: PeopleInMyOrganization
      AllowDialInBypassLobby: Block
      MeetNowPrivateMeetings: Allow
      LiveCaptions: NotEnabledButTheUserCanOverride
      ChatInMeetings: Allow
    references:
      ChannelMeetingScheduling: "see setting 'Channel meeting scheduling'"
      MeetNowInChannels: "see setting 'Meet now in channel meetings' and 'Meet now in private meetings'"

  - enforces: Org-wide default Teams live events policy
    with:
      Name: "Global"
      LiveEventScheduling: Allow
      TranscriptionForAttendees: Block
      WhoCanJoin: EveryoneInCompany
      RecordingMode: AlwaysEnabled

  - enforces: External access settings
    with:
      UsersInExternalOrgs: AllowEveryone || AllowOnlySpecificExternalDomains # TODO: ⭐️ discuss setting; what value(s) are we going to recommend?
      AllowedExternalDomains: "contoso.com" # Set this in a comma separated list; set to blank if all domains allowed
      ExternalAccessWithTrialTenants: Block
      MyOrgCanCommunicateWithUnmanagedAccounts: Block
      UnmanagedAccountsCanContactMyOrg: Block
      # UsersCanCommunicateWithSkypeUsers: Allow # not settable anymore (default policy in admin center)

  - enforces: Guest access settings
    with:
      AllowGuestsToAccessTeams: Allow
      MakePrivateCalls: Allow
      VideoConferencing: Allow
      ScreenSharingMode: EntireScreen
      MeetNow: Allow
      EditSentMessages: Allow
      DeleteSentMessages: Allow
      DeleteChat: Allow
      Chat: Allow
      GiphyInConversations: Block
      GiphyContentRating: Strict
      MemesInConversations: Block
      StickersInConversations: Block
      ImmerseReaderForMessages: Allow